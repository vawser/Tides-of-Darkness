
setup_ruler_refresh = {
    # Save all non-persistent aspects that need to be included in refreshed ruler
    
    # MAGIC
    set_variable = {
        which = REFRESH_ruler_magic_aptitude
        which = ruler_magic_aptitude
    }
    set_variable = {
        which = REFRESH_ruler_magic_finesse
        which = ruler_magic_finesse
    }
    set_variable = {
        which = REFRESH_ruler_magic_concentration
        which = ruler_magic_concentration
    }
    set_variable = {
        which = REFRESH_ruler_magic_mana
        which = ruler_magic_mana
    }
    
    # IMMORTALITY
    if = {
        limit = {
            has_ruler_flag = is_immortal
        }
        set_country_flag = REFRESH_is_immortal
    }
    
    # CLASS
    if = {
        limit = {
            has_ruler_flag = warrior_personality
        }
        set_country_flag = REFRESH_class_warrior_personality
    }
    if = {
        limit = {
            has_ruler_flag = paladin_personality
        }
        set_country_flag = REFRESH_class_paladin_personality
    }
    if = {
        limit = {
            has_ruler_flag = priest_personality
        }
        set_country_flag = REFRESH_class_priest_personality
    }
    if = {
        limit = {
            has_ruler_flag = rogue_personality
        }
        set_country_flag = REFRESH_class_rogue_personality
    }
    if = {
        limit = {
            has_ruler_flag = mage_personality
        }
        set_country_flag = REFRESH_class_mage_personality
    }
    if = {
        limit = {
            has_ruler_flag = warlock_personality
        }
        set_country_flag = REFRESH_class_warlock_personality
    }
    if = {
        limit = {
            has_ruler_flag = druid_personality
        }
        set_country_flag = REFRESH_class_druid_personality
    }
    if = {
        limit = {
            has_ruler_flag = hunter_personality
        }
        set_country_flag = REFRESH_class_hunter_personality
    }
    if = {
        limit = {
            has_ruler_flag = shaman_personality
        }
        set_country_flag = REFRESH_class_shaman_personality
    }
    if = {
        limit = {
            has_ruler_flag = death_knight_personality
        }
        set_country_flag = REFRESH_class_death_knight_personality
    }
    if = {
        limit = {
            has_ruler_flag = monk_personality
        }
        set_country_flag = REFRESH_class_monk_personality
    }
    if = {
        limit = {
            has_ruler_flag = demon_hunter_personality
        }
        set_country_flag = REFRESH_class_demon_hunter_personality
    }
    
    # PERSONALITY
    if = {
        limit = {
            ruler_has_personality = just_personality
        }
        set_country_flag = REFRESH_just_personality
    }
    if = {
        limit = {
            ruler_has_personality = righteous_personality
        }
        set_country_flag = REFRESH_righteous_personality
    }
    if = {
        limit = {
            ruler_has_personality = tolerant_personality
        }
        set_country_flag = REFRESH_tolerant_personality
    }
    if = {
        limit = {
            ruler_has_personality = kind_hearted_personality
        }
        set_country_flag = REFRESH_kind_hearted_personality
    }
    if = {
        limit = {
            ruler_has_personality = free_thinker_personality
        }
        set_country_flag = REFRESH_free_thinker_personality
    }
    if = {
        limit = {
            ruler_has_personality = well_connected_personality
        }
        set_country_flag = REFRESH_well_connected_personality
    }
    if = {
        limit = {
            ruler_has_personality = calm_personality
        }
        set_country_flag = REFRESH_calm_personality
    }
    if = {
        limit = {
            ruler_has_personality = careful_personality
        }
        set_country_flag = REFRESH_careful_personality
    }
    if = {
        limit = {
            ruler_has_personality = secretive_personality
        }
        set_country_flag = REFRESH_secretive_personality
    }
    if = {
        limit = {
            ruler_has_personality = intricate_web_weaver_personality
        }
        set_country_flag = REFRESH_intricate_web_weaver_personality
    }
    if = {
        limit = {
            ruler_has_personality = fertile_personality
        }
        set_country_flag = REFRESH_fertile_personality
    }
    if = {
        limit = {
            ruler_has_personality = well_advised_personality
        }
        set_country_flag = REFRESH_well_advised_personality
    }
    if = {
        limit = {
            ruler_has_personality = benevolent_personality
        }
        set_country_flag = REFRESH_benevolent_personality
    }
    if = {
        limit = {
            ruler_has_personality = zealot_personality
        }
        set_country_flag = REFRESH_zealot_personality
    }
    if = {
        limit = {
            ruler_has_personality = pious_personality
        }
        set_country_flag = REFRESH_pious_personality
    }
    if = {
        limit = {
            ruler_has_personality = lawgiver_personality
        }
        set_country_flag = REFRESH_lawgiver_personality
    }
    if = {
        limit = {
            ruler_has_personality = midas_touched_personality
        }
        set_country_flag = REFRESH_midas_touched_personality
    }
    if = {
        limit = {
            ruler_has_personality = incorruptible_personality
        }
        set_country_flag = REFRESH_incorruptible_personality
    }
    if = {
        limit = {
            ruler_has_personality = architectural_visionary_personality
        }
        set_country_flag = REFRESH_architectural_visionary_personality
    }
    if = {
        limit = {
            ruler_has_personality = scholar_personality
        }
        set_country_flag = REFRESH_scholar_personality
    }
    if = {
        limit = {
            ruler_has_personality = entrepreneur_personality
        }
        set_country_flag = REFRESH_entrepreneur_personality
    }
    if = {
        limit = {
            ruler_has_personality = industrious_personality
        }
        set_country_flag = REFRESH_industrious_personality
    }
    if = {
        limit = {
            ruler_has_personality = expansionist_personality
        }
        set_country_flag = REFRESH_expansionist_personality
    }
    if = {
        limit = {
            ruler_has_personality = charismatic_negotiator_personality
        }
        set_country_flag = REFRESH_charismatic_negotiator_personality
    }
    if = {
        limit = {
            ruler_has_personality = silver_tongue_personality
        }
        set_country_flag = REFRESH_silver_tongue_personality
    }
    if = {
        limit = {
            ruler_has_personality = conqueror_personality
        }
        set_country_flag = REFRESH_conqueror_personality
    }
    if = {
        limit = {
            ruler_has_personality = tactical_genius_personality
        }
        set_country_flag = REFRESH_tactical_genius_personality
    }
    if = {
        limit = {
            ruler_has_personality = bold_fighter_personality
        }
        set_country_flag = REFRESH_bold_fighter_personality
    }
    if = {
        limit = {
            ruler_has_personality = strict_personality
        }
        set_country_flag = REFRESH_strict_personality
    }
    if = {
        limit = {
            ruler_has_personality = inspiring_leader_personality
        }
        set_country_flag = REFRESH_inspiring_leader_personality
    }
    if = {
        limit = {
            ruler_has_personality = martial_educator_personality
        }
        set_country_flag = REFRESH_martial_educator_personality
    }
    if = {
        limit = {
            ruler_has_personality = navigator_personality
        }
        set_country_flag = REFRESH_navigator_personality
    }
    if = {
        limit = {
            ruler_has_personality = fierce_negotiator_personality
        }
        set_country_flag = REFRESH_fierce_negotiator_personality
    }
    if = {
        limit = {
            ruler_has_personality = babbling_buffoon_personality
        }
        set_country_flag = REFRESH_babbling_buffoon_personality
    }
    if = {
        limit = {
            ruler_has_personality = embezzler_personality
        }
        set_country_flag = REFRESH_embezzler_personality
    }
    if = {
        limit = {
            ruler_has_personality = infertile_personality
        }
        set_country_flag = REFRESH_infertile_personality
    }
    if = {
        limit = {
            ruler_has_personality = drunkard_personality
        }
        set_country_flag = REFRESH_drunkard_personality
    }
    if = {
        limit = {
            ruler_has_personality = sinner_personality
        }
        set_country_flag = REFRESH_sinner_personality
    }
    if = {
        limit = {
            ruler_has_personality = greedy_personality
        }
        set_country_flag = REFRESH_greedy_personality
    }
    if = {
        limit = {
            ruler_has_personality = cruel_personality
        }
        set_country_flag = REFRESH_cruel_personality
    }
    if = {
        limit = {
            ruler_has_personality = naive_personality
        }
        set_country_flag = REFRESH_naive_personality
    }
    if = {
        limit = {
            ruler_has_personality = craven_personality
        }
        set_country_flag = REFRESH_craven_personality
    }
    if = {
        limit = {
            ruler_has_personality = loose_lips_personality
        }
        set_country_flag = REFRESH_loose_lips_personality
    }
    if = {
        limit = {
            ruler_has_personality = obsessive_perfectionist_personality
        }
        set_country_flag = REFRESH_obsessive_perfectionist_personality
    }
    if = {
        limit = {
            ruler_has_personality = malevolent_personality
        }
        set_country_flag = REFRESH_malevolent_personality
    }
    if = {
        limit = {
            ruler_has_personality = immortal_personality
        }
        set_country_flag = REFRESH_immortal_personality
    }
    if = {
        limit = {
            ruler_has_personality = jack_of_all_trades_personality
        }
        set_country_flag = REFRESH_jack_of_all_trades_personality
    }
    if = {
        limit = {
            ruler_has_personality = renaissance_man_personality
        }
        set_country_flag = REFRESH_renaissance_man_personality
    }
    if = {
        limit = {
            ruler_has_personality = renaissance_woman_personality
        }
        set_country_flag = REFRESH_renaissance_woman_personality
    }
    if = {
        limit = {
            ruler_has_personality = ambitious_personality
        }
        set_country_flag = REFRESH_ambitious_personality
    }
    if = {
        limit = {
            ruler_has_personality = chaste_personality
        }
        set_country_flag = REFRESH_chaste_personality
    }
    if = {
        limit = {
            ruler_has_personality = filially_pious_personality
        }
        set_country_flag = REFRESH_filially_pious_personality
    }
    if = {
        limit = {
            ruler_has_personality = crusader_personality
        }
        set_country_flag = REFRESH_crusader_personality
    }
    if = {
        limit = {
            ruler_has_personality = bishamonten_personality
        }
        set_country_flag = REFRESH_bishamonten_personality
    }
    if = {
        limit = {
            ruler_has_personality = farr_gifted_personality
        }
        set_country_flag = REFRESH_farr_gifted_personality
    }
    if = {
        limit = {
            ruler_has_personality = peaceful_trader_personality
        }
        set_country_flag = REFRESH_peaceful_trader_personality
    }
    if = {
        limit = {
            ruler_has_personality = gregarious_personality
        }
        set_country_flag = REFRESH_gregarious_personality
    }
    if = {
        limit = {
            ruler_has_personality = sotapanna_personality
        }
        set_country_flag = REFRESH_sotapanna_personality
    }
    if = {
        limit = {
            ruler_has_personality = keen_recruiter_personality
        }
        set_country_flag = REFRESH_keen_recruiter_personality
    }
    if = {
        limit = {
            ruler_has_personality = talented_poet_personality
        }
        set_country_flag = REFRESH_talented_poet_personality
    }
    if = {
        limit = {
            ruler_has_personality = logistics_expert_personality
        }
        set_country_flag = REFRESH_logistics_expert_personality
    }
    if = {
        limit = {
            ruler_has_personality = humble_personality
        }
        set_country_flag = REFRESH_humble_personality
    }
    if = {
        limit = {
            ruler_has_personality = earthwork_expert_personality
        }
        set_country_flag = REFRESH_earthwork_expert_personality
    }
    if = {
        limit = {
            ruler_has_personality = cultured_personality
        }
        set_country_flag = REFRESH_cultured_personality
    }
    if = {
        limit = {
            ruler_has_personality = crafty_merchant_personality
        }
        set_country_flag = REFRESH_crafty_merchant_personality
    }
    if = {
        limit = {
            ruler_has_personality = impartial_personality
        }
        set_country_flag = REFRESH_impartial_personality
    }
    if = {
        limit = {
            ruler_has_personality = puppet_master_personality
        }
        set_country_flag = REFRESH_puppet_master_personality
    }
    if = {
        limit = {
            ruler_has_personality = galvanizing_orator_personality
        }
        set_country_flag = REFRESH_galvanizing_orator_personality
    }
    if = {
        limit = {
            ruler_has_personality = reliable_personality
        }
        set_country_flag = REFRESH_reliable_personality
    }
    if = {
        limit = {
            ruler_has_personality = defiant_personality
        }
        set_country_flag = REFRESH_defiant_personality
    }
    if = {
        limit = {
            ruler_has_personality = provacateur_personality
        }
        set_country_flag = REFRESH_provacateur_personality
    }
    if = {
        limit = {
            ruler_has_personality = populist_personality
        }
        set_country_flag = REFRESH_populist_personality
    }
    if = {
        limit = {
            ruler_has_personality = avowed_pacifist_personality
        }
        set_country_flag = REFRESH_avowed_pacifist_personality
    }
    if = {
        limit = {
            ruler_has_personality = good_caesar_personality
        }
        set_country_flag = REFRESH_good_caesar_personality
    }
    if = {
        limit = {
            ruler_has_personality = prodigy_personality
        }
        set_country_flag = REFRESH_prodigy_personality
    }
    if = {
        limit = {
            ruler_has_personality = impaler_personality
        }
        set_country_flag = REFRESH_impaler_personality
    }
    if = {
        limit = {
            ruler_has_personality = extravagant_personality
        }
        set_country_flag = REFRESH_extravagant_personality
    }
    if = {
        limit = {
            ruler_has_personality = easygoing_personality
        }
        set_country_flag = REFRESH_easygoing_personality
    }
    if = {
        limit = {
            ruler_has_personality = puritan_personality
        }
        set_country_flag = REFRESH_puritan_personality
    }
    if = {
        limit = {
            ruler_has_personality = seducer_personality
        }
        set_country_flag = REFRESH_seducer_personality
    }
    if = {
        limit = {
            ruler_has_personality = seductress_personality
        }
        set_country_flag = REFRESH_seductress_personality
    }
    if = {
        limit = {
            ruler_has_personality = proud_personality
        }
        set_country_flag = REFRESH_proud_personality
    }
    if = {
        limit = {
            ruler_has_personality = cynical_personality
        }
        set_country_flag = REFRESH_cynical_personality
    }
    if = {
        limit = {
            ruler_has_personality = trusting_personality
        }
        set_country_flag = REFRESH_trusting_personality
    }
    if = {
        limit = {
            ruler_has_personality = hotheaded_personality
        }
        set_country_flag = REFRESH_hotheaded_personality
    }
    if = {
        limit = {
            ruler_has_personality = reckless_leader_personality
        }
        set_country_flag = REFRESH_reckless_leader_personality
    }
    if = {
        limit = {
            ruler_has_personality = unorthodox_personality
        }
        set_country_flag = REFRESH_unorthodox_personality
    }
    if = {
        limit = {
            ruler_has_personality = ethnocentric_personality
        }
        set_country_flag = REFRESH_ethnocentric_personality
    }
    if = {
        limit = {
            ruler_has_personality = pyromaniac_personality
        }
        set_country_flag = REFRESH_pyromaniac_personality
    }
    if = {
        limit = {
            ruler_has_personality = ruthless_personality
        }
        set_country_flag = REFRESH_ruthless_personality
    }
    if = {
        limit = {
            ruler_has_personality = overly_generous_personality
        }
        set_country_flag = REFRESH_overly_generous_personality
    }
    if = {
        limit = {
            ruler_has_personality = paranoid_personality
        }
        set_country_flag = REFRESH_paranoid_personality
    }
    if = {
        limit = {
            ruler_has_personality = immature_personality
        }
        set_country_flag = REFRESH_immature_personality
    }
    if = {
        limit = {
            ruler_has_personality = lustful_personality
        }
        set_country_flag = REFRESH_lustful_personality
    }
    if = {
        limit = {
            ruler_has_personality = unfaithful_personality
        }
        set_country_flag = REFRESH_unfaithful_personality
    }
    if = {
        limit = {
            ruler_has_personality = overbearing_personality
        }
        set_country_flag = REFRESH_overbearing_personality
    }
    if = {
        limit = {
            ruler_has_personality = indecisive_personality
        }
        set_country_flag = REFRESH_indecisive_personality
    }
    if = {
        limit = {
            ruler_has_personality = sadistic_personality
        }
        set_country_flag = REFRESH_sadistic_personality
    }
    if = {
        limit = {
            ruler_has_personality = barbaric_personality
        }
        set_country_flag = REFRESH_barbaric_personality
    }
    if = {
        limit = {
            ruler_has_personality = xenophobic_personality
        }
        set_country_flag = REFRESH_xenophobic_personality
    }
    if = {
        limit = {
            ruler_has_personality = inferiority_complex_personality
        }
        set_country_flag = REFRESH_inferiority_complex_personality
    }
    if = {
        limit = {
            ruler_has_personality = dull_personality
        }
        set_country_flag = REFRESH_dull_personality
    }
    if = {
        limit = {
            ruler_has_personality = treacherous_personality
        }
        set_country_flag = REFRESH_treacherous_personality
    }
    if = {
        limit = {
            ruler_has_personality = timid_personality
        }
        set_country_flag = REFRESH_timid_personality
    }
    if = {
        limit = {
            ruler_has_personality = content_personality
        }
        set_country_flag = REFRESH_content_personality
    }
    if = {
        limit = {
            ruler_has_personality = envious_personality
        }
        set_country_flag = REFRESH_envious_personality
    }
    if = {
        limit = {
            ruler_has_personality = slothful_personality
        }
        set_country_flag = REFRESH_slothful_personality
    }
    if = {
        limit = {
            ruler_has_personality = unprincipled_ruffian_personality
        }
        set_country_flag = REFRESH_unprincipled_ruffian_personality
    }
    if = {
        limit = {
            ruler_has_personality = senile_personality
        }
        set_country_flag = REFRESH_senile_personality
    }
    
    # Exile ruler
    exile_ruler_as = refresh_ruler
}

refresh_ruler = {
    set_ruler = refresh_ruler
    
    hidden_effect = {
        # PERSONALITy
        if = {
            limit = {
                has_country_flag = REFRESH_just_personality
            }
            add_ruler_personality = just_personality
            clr_country_flag = REFRESH_just_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_righteous_personality
            }
            add_ruler_personality = righteous_personality
            clr_country_flag = REFRESH_righteous_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_tolerant_personality
            }
            add_ruler_personality = tolerant_personality
            clr_country_flag = REFRESH_tolerant_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_kind_hearted_personality
            }
            add_ruler_personality = kind_hearted_personality
            clr_country_flag = REFRESH_kind_hearted_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_free_thinker_personality
            }
            add_ruler_personality = free_thinker_personality
            clr_country_flag = REFRESH_free_thinker_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_well_connected_personality
            }
            add_ruler_personality = well_connected_personality
            clr_country_flag = REFRESH_well_connected_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_calm_personality
            }
            add_ruler_personality = calm_personality
            clr_country_flag = REFRESH_calm_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_careful_personality
            }
            add_ruler_personality = careful_personality
            clr_country_flag = REFRESH_careful_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_secretive_personality
            }
            add_ruler_personality = secretive_personality
            clr_country_flag = REFRESH_secretive_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_intricate_web_weaver_personality
            }
            add_ruler_personality = intricate_web_weaver_personality
            clr_country_flag = REFRESH_intricate_web_weaver_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_fertile_personality
            }
            add_ruler_personality = fertile_personality
            clr_country_flag = REFRESH_fertile_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_well_advised_personality
            }
            add_ruler_personality = well_advised_personality
            clr_country_flag = REFRESH_well_advised_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_benevolent_personality
            }
            add_ruler_personality = benevolent_personality
            clr_country_flag = REFRESH_benevolent_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_zealot_personality
            }
            add_ruler_personality = zealot_personality
            clr_country_flag = REFRESH_zealot_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_pious_personality
            }
            add_ruler_personality = pious_personality
            clr_country_flag = REFRESH_pious_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_lawgiver_personality
            }
            add_ruler_personality = lawgiver_personality
            clr_country_flag = REFRESH_lawgiver_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_midas_touched_personality
            }
            add_ruler_personality = midas_touched_personality
            clr_country_flag = REFRESH_midas_touched_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_incorruptible_personality
            }
            add_ruler_personality = incorruptible_personality
            clr_country_flag = REFRESH_incorruptible_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_architectural_visionary_personality
            }
            add_ruler_personality = architectural_visionary_personality
            clr_country_flag = REFRESH_architectural_visionary_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_scholar_personality
            }
            add_ruler_personality = scholar_personality
            clr_country_flag = REFRESH_scholar_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_entrepreneur_personality
            }
            add_ruler_personality = entrepreneur_personality
            clr_country_flag = REFRESH_entrepreneur_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_industrious_personality
            }
            add_ruler_personality = industrious_personality
            clr_country_flag = REFRESH_industrious_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_expansionist_personality
            }
            add_ruler_personality = expansionist_personality
            clr_country_flag = REFRESH_expansionist_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_charismatic_negotiator_personality
            }
            add_ruler_personality = charismatic_negotiator_personality
            clr_country_flag = REFRESH_charismatic_negotiator_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_silver_tongue_personality
            }
            add_ruler_personality = silver_tongue_personality
            clr_country_flag = REFRESH_silver_tongue_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_conqueror_personality
            }
            add_ruler_personality = conqueror_personality
            clr_country_flag = REFRESH_conqueror_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_tactical_genius_personality
            }
            add_ruler_personality = tactical_genius_personality
            clr_country_flag = REFRESH_tactical_genius_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_bold_fighter_personality
            }
            add_ruler_personality = bold_fighter_personality
            clr_country_flag = REFRESH_bold_fighter_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_strict_personality
            }
            add_ruler_personality = strict_personality
            clr_country_flag = REFRESH_strict_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_inspiring_leader_personality
            }
            add_ruler_personality = inspiring_leader_personality
            clr_country_flag = REFRESH_inspiring_leader_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_martial_educator_personality
            }
            add_ruler_personality = martial_educator_personality
            clr_country_flag = REFRESH_martial_educator_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_navigator_personality
            }
            add_ruler_personality = navigator_personality
            clr_country_flag = REFRESH_navigator_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_fierce_negotiator_personality
            }
            add_ruler_personality = fierce_negotiator_personality
            clr_country_flag = REFRESH_fierce_negotiator_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_babbling_buffoon_personality
            }
            add_ruler_personality = babbling_buffoon_personality
            clr_country_flag = REFRESH_babbling_buffoon_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_embezzler_personality
            }
            add_ruler_personality = embezzler_personality
            clr_country_flag = REFRESH_embezzler_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_infertile_personality
            }
            add_ruler_personality = infertile_personality
            clr_country_flag = REFRESH_infertile_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_drunkard_personality
            }
            add_ruler_personality = drunkard_personality
            clr_country_flag = REFRESH_drunkard_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_sinner_personality
            }
            add_ruler_personality = sinner_personality
            clr_country_flag = REFRESH_sinner_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_greedy_personality
            }
            add_ruler_personality = greedy_personality
            clr_country_flag = REFRESH_greedy_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_cruel_personality
            }
            add_ruler_personality = cruel_personality
            clr_country_flag = REFRESH_cruel_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_naive_personality
            }
            add_ruler_personality = naive_personality
            clr_country_flag = REFRESH_naive_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_craven_personality
            }
            add_ruler_personality = craven_personality
            clr_country_flag = REFRESH_craven_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_loose_lips_personality
            }
            add_ruler_personality = loose_lips_personality
            clr_country_flag = REFRESH_loose_lips_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_obsessive_perfectionist_personality
            }
            add_ruler_personality = obsessive_perfectionist_personality
            clr_country_flag = REFRESH_obsessive_perfectionist_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_malevolent_personality
            }
            add_ruler_personality = malevolent_personality
            clr_country_flag = REFRESH_malevolent_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_immortal_personality
            }
            add_ruler_personality = immortal_personality
            clr_country_flag = REFRESH_immortal_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_jack_of_all_trades_personality
            }
            add_ruler_personality = jack_of_all_trades_personality
            clr_country_flag = REFRESH_jack_of_all_trades_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_renaissance_man_personality
            }
            add_ruler_personality = renaissance_man_personality
            clr_country_flag = REFRESH_renaissance_man_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_renaissance_woman_personality
            }
            add_ruler_personality = renaissance_woman_personality
            clr_country_flag = REFRESH_renaissance_woman_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_ambitious_personality
            }
            add_ruler_personality = ambitious_personality
            clr_country_flag = REFRESH_ambitious_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_chaste_personality
            }
            add_ruler_personality = chaste_personality
            clr_country_flag = REFRESH_chaste_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_filially_pious_personality
            }
            add_ruler_personality = filially_pious_personality
            clr_country_flag = REFRESH_filially_pious_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_crusader_personality
            }
            add_ruler_personality = crusader_personality
            clr_country_flag = REFRESH_crusader_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_bishamonten_personality
            }
            add_ruler_personality = bishamonten_personality
            clr_country_flag = REFRESH_bishamonten_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_farr_gifted_personality
            }
            add_ruler_personality = farr_gifted_personality
            clr_country_flag = REFRESH_farr_gifted_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_peaceful_trader_personality
            }
            add_ruler_personality = peaceful_trader_personality
            clr_country_flag = REFRESH_peaceful_trader_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_gregarious_personality
            }
            add_ruler_personality = gregarious_personality
            clr_country_flag = REFRESH_gregarious_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_sotapanna_personality
            }
            add_ruler_personality = sotapanna_personality
            clr_country_flag = REFRESH_sotapanna_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_keen_recruiter_personality
            }
            add_ruler_personality = keen_recruiter_personality
            clr_country_flag = REFRESH_keen_recruiter_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_talented_poet_personality
            }
            add_ruler_personality = talented_poet_personality
            clr_country_flag = REFRESH_talented_poet_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_logistics_expert_personality
            }
            add_ruler_personality = logistics_expert_personality
            clr_country_flag = REFRESH_logistics_expert_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_humble_personality
            }
            add_ruler_personality = humble_personality
            clr_country_flag = REFRESH_humble_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_earthwork_expert_personality
            }
            add_ruler_personality = earthwork_expert_personality
            clr_country_flag = REFRESH_earthwork_expert_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_cultured_personality
            }
            add_ruler_personality = cultured_personality
            clr_country_flag = REFRESH_cultured_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_crafty_merchant_personality
            }
            add_ruler_personality = crafty_merchant_personality
            clr_country_flag = REFRESH_crafty_merchant_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_impartial_personality
            }
            add_ruler_personality = impartial_personality
            clr_country_flag = REFRESH_impartial_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_puppet_master_personality
            }
            add_ruler_personality = puppet_master_personality
            clr_country_flag = REFRESH_puppet_master_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_galvanizing_orator_personality
            }
            add_ruler_personality = galvanizing_orator_personality
            clr_country_flag = REFRESH_galvanizing_orator_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_reliable_personality
            }
            add_ruler_personality = reliable_personality
            clr_country_flag = REFRESH_reliable_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_defiant_personality
            }
            add_ruler_personality = defiant_personality
            clr_country_flag = REFRESH_defiant_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_provacateur_personality
            }
            add_ruler_personality = provacateur_personality
            clr_country_flag = REFRESH_provacateur_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_populist_personality
            }
            add_ruler_personality = populist_personality
            clr_country_flag = REFRESH_populist_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_avowed_pacifist_personality
            }
            add_ruler_personality = avowed_pacifist_personality
            clr_country_flag = REFRESH_avowed_pacifist_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_good_caesar_personality
            }
            add_ruler_personality = good_caesar_personality
            clr_country_flag = REFRESH_good_caesar_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_prodigy_personality
            }
            add_ruler_personality = prodigy_personality
            clr_country_flag = REFRESH_prodigy_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_impaler_personality
            }
            add_ruler_personality = impaler_personality
            clr_country_flag = REFRESH_impaler_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_extravagant_personality
            }
            add_ruler_personality = extravagant_personality
            clr_country_flag = REFRESH_extravagant_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_easygoing_personality
            }
            add_ruler_personality = easygoing_personality
            clr_country_flag = REFRESH_easygoing_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_puritan_personality
            }
            add_ruler_personality = puritan_personality
            clr_country_flag = REFRESH_puritan_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_seducer_personality
            }
            add_ruler_personality = seducer_personality
            clr_country_flag = REFRESH_seducer_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_seductress_personality
            }
            add_ruler_personality = seductress_personality
            clr_country_flag = REFRESH_seductress_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_proud_personality
            }
            add_ruler_personality = proud_personality
            clr_country_flag = REFRESH_proud_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_cynical_personality
            }
            add_ruler_personality = cynical_personality
            clr_country_flag = REFRESH_cynical_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_trusting_personality
            }
            add_ruler_personality = trusting_personality
            clr_country_flag = REFRESH_trusting_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_hotheaded_personality
            }
            add_ruler_personality = hotheaded_personality
            clr_country_flag = REFRESH_hotheaded_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_reckless_leader_personality
            }
            add_ruler_personality = reckless_leader_personality
            clr_country_flag = REFRESH_reckless_leader_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_unorthodox_personality
            }
            add_ruler_personality = unorthodox_personality
            clr_country_flag = REFRESH_unorthodox_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_ethnocentric_personality
            }
            add_ruler_personality = ethnocentric_personality
            clr_country_flag = REFRESH_ethnocentric_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_pyromaniac_personality
            }
            add_ruler_personality = pyromaniac_personality
            clr_country_flag = REFRESH_pyromaniac_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_ruthless_personality
            }
            add_ruler_personality = ruthless_personality
            clr_country_flag = REFRESH_ruthless_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_overly_generous_personality
            }
            add_ruler_personality = overly_generous_personality
            clr_country_flag = REFRESH_overly_generous_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_paranoid_personality
            }
            add_ruler_personality = paranoid_personality
            clr_country_flag = REFRESH_paranoid_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_immature_personality
            }
            add_ruler_personality = immature_personality
            clr_country_flag = REFRESH_immature_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_lustful_personality
            }
            add_ruler_personality = lustful_personality
            clr_country_flag = REFRESH_lustful_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_unfaithful_personality
            }
            add_ruler_personality = unfaithful_personality
            clr_country_flag = REFRESH_unfaithful_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_overbearing_personality
            }
            add_ruler_personality = overbearing_personality
            clr_country_flag = REFRESH_overbearing_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_indecisive_personality
            }
            add_ruler_personality = indecisive_personality
            clr_country_flag = REFRESH_indecisive_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_sadistic_personality
            }
            add_ruler_personality = sadistic_personality
            clr_country_flag = REFRESH_sadistic_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_barbaric_personality
            }
            add_ruler_personality = barbaric_personality
            clr_country_flag = REFRESH_barbaric_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_xenophobic_personality
            }
            add_ruler_personality = xenophobic_personality
            clr_country_flag = REFRESH_xenophobic_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_inferiority_complex_personality
            }
            add_ruler_personality = inferiority_complex_personality
            clr_country_flag = REFRESH_inferiority_complex_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_dull_personality
            }
            add_ruler_personality = dull_personality
            clr_country_flag = REFRESH_dull_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_treacherous_personality
            }
            add_ruler_personality = treacherous_personality
            clr_country_flag = REFRESH_treacherous_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_timid_personality
            }
            add_ruler_personality = timid_personality
            clr_country_flag = REFRESH_timid_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_content_personality
            }
            add_ruler_personality = content_personality
            clr_country_flag = REFRESH_content_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_envious_personality
            }
            add_ruler_personality = envious_personality
            clr_country_flag = REFRESH_envious_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_slothful_personality
            }
            add_ruler_personality = slothful_personality
            clr_country_flag = REFRESH_slothful_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_unprincipled_ruffian_personality
            }
            add_ruler_personality = unprincipled_ruffian_personality
            clr_country_flag = REFRESH_unprincipled_ruffian_personality
        }
        if = {
            limit = {
                has_country_flag = REFRESH_senile_personality
            }
            add_ruler_personality = senile_personality
            clr_country_flag = REFRESH_senile_personality
        }

        # MAGIC
        add_ruler_modifier = {
            name = spellcaster_capabilities
            duration = -1
        }
        
        set_variable = {
            which = ruler_magic_aptitude
            which = REFRESH_ruler_magic_aptitude
        }
        set_variable = {
            which = ruler_magic_finesse
            which = REFRESH_ruler_magic_finesse
        }
        set_variable = {
            which = ruler_magic_concentration
            which = REFRESH_ruler_magic_concentration
        }
        set_variable = {
            which = ruler_magic_mana
            which = REFRESH_ruler_magic_mana
        }
        set_variable = {
            which = REFRESH_ruler_magic_aptitude
            value = 0
        }
        set_variable = {
            which = REFRESH_ruler_magic_finesse
            value = 0
        }
        set_variable = {
            which = REFRESH_ruler_magic_concentration
            value = 0
        }
        set_variable = {
            which = REFRESH_ruler_magic_mana
            value = 0
        }
        
        if = {
            limit = {
                has_country_flag = REFRESH_class_warrior_personality
            }
            clr_country_flag = REFRESH_class_warrior_personality
            trained_as_warrior = yes
        }
        if = {
            limit = {
                has_country_flag = REFRESH_class_paladin_personality
            }
            clr_country_flag = REFRESH_class_paladin_personality
            trained_as_paladin = yes
        }
        if = {
            limit = {
                has_country_flag = REFRESH_class_priest_personality
            }
            clr_country_flag = REFRESH_class_priest_personality
            trained_as_priest = yes
        }
        if = {
            limit = {
                has_country_flag = REFRESH_class_rogue_personality
            }
            clr_country_flag = REFRESH_class_rogue_personality
            trained_as_rogue = yes
        }
        if = {
            limit = {
                has_country_flag = REFRESH_class_mage_personality
            }
            clr_country_flag = REFRESH_class_mage_personality
            trained_as_mage = yes
        }
        if = {
            limit = {
                has_country_flag = REFRESH_class_warlock_personality
            }
            clr_country_flag = REFRESH_class_warlock_personality
            trained_as_warlock = yes
        }
        if = {
            limit = {
                has_country_flag = REFRESH_class_druid_personality
            }
            clr_country_flag = REFRESH_class_druid_personality
            trained_as_druid = yes
        }
        if = {
            limit = {
                has_country_flag = REFRESH_class_hunter_personality
            }
            clr_country_flag = REFRESH_class_hunter_personality
            trained_as_hunter = yes
        }
        if = {
            limit = {
                has_country_flag = REFRESH_class_shaman_personality
            }
            clr_country_flag = REFRESH_class_shaman_personality
            trained_as_shaman = yes
        }
        if = {
            limit = {
                has_country_flag = REFRESH_class_death_knight_personality
            }
            clr_country_flag = REFRESH_class_death_knight_personality
            trained_as_death_knight = yes
        }
        if = {
            limit = {
                has_country_flag = REFRESH_class_monk_personality
            }
            clr_country_flag = REFRESH_class_monk_personality
            trained_as_monk = yes
        }
        if = {
            limit = {
                has_country_flag = REFRESH_class_demon_hunter_personality
            }
            clr_country_flag = REFRESH_class_demon_hunter_personality
            trained_as_demon_hunter = yes
        }
        
        # IMMORTALITY
        if = {
            limit = {
                has_country_flag = REFRESH_is_immortal
            }
            set_ruler_flag = is_immortal
            clr_country_flag = REFRESH_is_immortal
        }
    }
}
